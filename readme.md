[![Build Status](https://travis-ci.org/42antoine/laravel-sudoku.svg?branch=master)](https://travis-ci.org/42antoine/laravel-sudoku)

# How this project was created

    $> composer create-project --prefer-dist laravel/laravel sudoku

## Remove Laravel vueJS, Axios and Lodash components

Please follow instruciton here : https://mattstauffer.co/blog/removing-all-vue-dependencies-from-laravel

Then, add token and environment utilities for jQuery, look at the following file :

    resources/assets/js/bootstrap.js
    
& add to your metadatas, in layout, the following metadata
    
    <meta name="environment" content="{{ config('app.env') }}">
    <meta name="csrf-token" content="{{ csrf_token() }}">

### Add version in webpack.mix.js

    if (mix.config.inProduction) {
    	mix.version();
    }
    
Then, recreate assets stuff

    $> npm run prod


Personal notes : After updating nodejs, you could have to rebuild node-sass

    $> npm rebuild node-sass --force

# Configure database & auth

1/ edit stuff in environment file ".env" (note that .env.example is setting up for docker)

2/ migrate database

    $> php artisan migrate

Personal notes : If you are using MySQL < 5.7 or MariaDB < 10.2, add to your migrations files

    // Prevent errors on MySQL < 5.7 or MariaDB < 10.2
    Schema::defaultStringLength(191);

see also : https://github.com/laravel/framework/issues/17508

3/ make auth stuff

    $> php artisan make:auth

see also : https://laravel.com/docs/5.4/authentication

# Switch application to domain driven and hexagonal architecture

## Update composer.json to autoload to namespace the app with is real name "sudoku"

    "autoload": {
        
        ...
        
        "psr-4": {
            "sudoku\\": "app/"
        }
        
        ...
        
    },

- Move app/Providers to app/App/Providers
- Move app/User to app/Domain/Users/Users
- Create app/Infrastructure

### What the hell ?

- app/App namespace sudoku\App -> the application utilities (like : events, providers, notifications, everything that laravel does alone)
- app/Console namespace sudoku\Console -> Every output generated by console commands
- app/Exceptions namespace sudoku\Exceptions -> Every output generated by exceptions
- app/Http namespace sudoku\Http -> Every output generated by HTTP requests
- app/Domain namespace sudoku\Domain -> The application domain, the working part relative to the customer domain
- app/Infrastructure name sudoku\Infrastructure -> Linking Interfaces and Contracts (abstractions classes) that allow vendor pacakages, laravel and Domain to work together (Force rules via Interfaces or specific behaviours via abstractions classes)

See also : http://fideloper.com/hexagonal-architecture

# Install sudoku library and develop the specific domain (the service provides by the application)

    $> composer require xeeeveee/sudoku

This package use backtrack algorithm to resolve a sudoku, it is also able to generate a sudoku grid 

See also : https://github.com/xeeeveee/sudoku

# Use docker with laradock to run the project

## Prepare the environment file to work with docker

    $> cp .env.example .env

The docker containers are set to be use from this 127.0.0.1:SPECIFI_PORT on localhost

- website : http://127.0.0.1:8004
- mysql : http://127.0.0.1:3604
- mailhog : http://127.0.0.1:8029

## start / stop docker :

    $> docker-compose --project-name sudoku up -d apache2 php-fpm mysql mailhog
    $> docker-compose --project-name sudoku stop
    $> docker-compose --project-name sudoku exec workspace php /var/www/artisan migrate

### shortcuts in composer

    $> composer docker
    $> composer docker-stop
    $> composer docker-artisan-migrate

## unit testing from docker

    $> docker-compose --project-name sudoku exec workspace /var/www/vendor/bin/phpunit
    $> docker-compose --project-name sudoku exec workspace /var/www/vendor/bin/phpcs --standard=/var/www/vendor/pragmarx/laravelcs/Standards/Laravel/ app
    $> docker-compose --project-name sudoku exec workspace /var/www/vendor/bin/phpcpd app

### shortcuts in composer
    
    $> composer docker-test
    $> composer docker-test-phpcs
    $> composer docker-test-phpcs-duplicated

# Sudoku commands

    $> php artisan help sudoku:resolve
    $> php artisan sudoku:resolve <path to file with sudoku as raw format>
    
    $> php artisan sudoku:resolve storage/tests/sudoku_easy.txt
    $> php artisan sudoku:resolve storage/tests/sudoku_medium.txt
    $> php artisan sudoku:resolve storage/tests/sudoku_hard.txt
